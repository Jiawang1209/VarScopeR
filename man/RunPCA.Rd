% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunPCA.R
\name{RunPCA}
\alias{RunPCA}
\title{Run Principal Component Analysis (PCA) on ASV/feature data}
\usage{
RunPCA(
  object,
  assay = "scale",
  features = NULL,
  npcs = 10,
  reduction.name = "pca",
  seed = 1115
)
}
\arguments{
\item{object}{A \code{VarScope} object containing normalized or scaled data.}

\item{assay}{Character. Name of the assay to use for PCA (default: "scale").}

\item{features}{Character vector or NULL. Features to use for PCA. If NULL,
uses all features or variable features if available.}

\item{npcs}{Integer. Number of principal components to compute (default: 10).}

\item{reduction.name}{Character. Name to store the PCA reduction
(default: "pca").}

\item{seed}{Integer. Random seed for reproducibility (default: 1115).}
}
\value{
A \code{VarScope} object with PCA results stored in
  \code{object$reductions[[reduction.name]]}. The reduction contains:
  \itemize{
    \item \code{scores}: Matrix of ASV coordinates in PC space (ASVs × PCs)
      - This is the main output for ASV clustering
    \item \code{loadings}: Matrix of sample loadings (samples × PCs)
      - Contribution of each sample to each PC
    \item \code{sdev}: Standard deviations of principal components
    \item \code{var.explained}: Proportion of variance explained by each PC
  }
}
\description{
Perform PCA on ASV/feature abundance data. The analysis is performed on the
ASV/feature dimension, returning ASV coordinates in PC space (PC1-PC10 by default)
for ASV clustering. Each ASV is represented as a point in the PC space based on
its abundance pattern across samples.
}
\examples{
\dontrun{
vsobj <- CreateVarScopeObject(
  counts = "inst/extdata/otutab.txt",
  meta.data = "inst/extdata/group.csv"
)
vsobj <- NormalizeData(vsobj, normalization.method = "log2")
vsobj <- FindVariableFeatures(vsobj)
vsobj <- ScaleData(vsobj)
vsobj <- RunPCA(vsobj, npcs = 10)

# Access ASV coordinates in PC space (for ASV clustering)
asv_pc_coords <- vsobj$reductions$pca$scores  # ASVs × PCs

# Access sample loadings
sample_loadings <- vsobj$reductions$pca$loadings  # samples × PCs
}
}
